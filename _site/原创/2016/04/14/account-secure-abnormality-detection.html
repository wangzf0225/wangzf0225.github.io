<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>账号安全的异常检测</title>
  <meta name="description" content="摘要这篇文章收集了一些学术界和著名的社交网络公司在针对异常账号的识别和检测的研究成果，总结了常见的几种算法，并对比其优劣。希望能在这篇文章的基础上，针对陌陌的实际情况，和大家共同探讨出一套可行的工程实践方案，解决账号安全这个“老大难”问题。0x00 引言在线社交网络（Online Social Networks,...">

  <!-- evil icon -->

  <link rel="stylesheet" href="/assets/evil-icons.min.css">
  <script src="/assets/evil-icons.min.js"></script>

  <!-- todo: include this into main.css -->

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/%E5%8E%9F%E5%88%9B/2016/04/14/account-secure-abnormality-detection.html">
  <link rel="alternate" type="application/rss+xml" title="INVOKER" href="http://localhost:4000/feed.xml">
</head>

  <body>
    <div class="page-content">
      <div class="container">
        <div class="three columns">
          <header class="site-header">

  <h2 class="logo"><a href="/">INVOKER</a></h2>

  <div class="nav">
    
    <label for="menu-toggle" class="menu-icon">
        <!--div data-icon="ei-navicon"></div-->
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
    </label>
    <input type="checkbox" id="menu-toggle">

    <div class="site-nav">
      <nav>
        <ul class="page-link">
          <li><a href="/">Home</a></li>
          <li><a href="/archive">Posts</a></li>
          <li><a href="/about">About</a></li>
          <li><a href="/feed.xml">RSS</a></li>
        </ul>
      </nav>
    </div>

  </div>
</header>

        </div>

        <div class="nine columns" style="z-index:100;">
          <div class="wrapper">
            <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="artilce_header">
    <h1 class="artilce_title" itemprop="name headline">账号安全的异常检测</h1>
    <p class="artilce_meta"><time datetime="2016-04-14T16:06:26+08:00" itemprop="datePublished">Apr 14, 2016</time></p>
  </header>

  <div class="article-content" itemprop="articleBody">
    <h2 id="摘要">摘要</h2>

<p>这篇文章收集了一些学术界和著名的社交网络公司在针对异常账号的识别和检测的研究成果，总结了常见的几种算法，并对比其优劣。希望能在这篇文章的基础上，针对陌陌的实际情况，和大家共同探讨出一套可行的工程实践方案，解决账号安全这个“老大难”问题。</p>

<h2 id="0x00-引言">0x00 引言</h2>

<p>在线社交网络（Online Social Networks, OSN）也称为社会媒体网络（Social Media Networks，SMN）或社交网站（Social Network Sites，SNS），它是Web2.0时代的产物。社交网络出现，给人们的生活增添了许多新的方式。社交网络具有用户规模大、响应速度快的特点，而这些社交网络与生俱来的优势，也成为不法分子谋取利益的温床：他们会通过注册僵尸账号，或者盗用正常用户的帐号，在社交网站中发布广告、色情、钓鱼等恶意信息 ，通过不法交易或者诈骗等行为获得经济利益；也有一部分极端分子，利用社交网络扩散虚假、煽动性甚至恐怖信息。这些因素都会对在线社交网络的信誉评价体系以及用户的信任关系产生严重危害。</p>

<p>总体而言，异常帐号检测主要涉及3方面的内容：</p>

<p>（1）异常帐号的表现。</p>

<p>（2）检测方案的设计。</p>

<p>（3）检测方案的验证。</p>

<h2 id="0x01-异常账号的表现">0x01 异常账号的表现</h2>

<p>社交网络是近些年非常热门的一类互联网应用，它具有用户规模大、产品形态丰富的特点，因此，不同的类型的社交产品账号具有形态各异的表现。此外，帐号的表现是一个变化的过程，在用户使用账号的不同阶段，其表现会有差异。账号异常检测的目标，就是选取合适的维度，将正常的账号和异常账号的表现区分开。</p>

<p>在过去的实践中，我们往往通过观察正常账号和异常账号的行为特征的差异来区分这两者。例如，正常账号通常来自一个IP地址，而这个IP地址也只能登录一个或者极少数几个账号，但是对于异常账号的控制者而言，他们会用一个IP去登录很多账号；再比如，一个正常用户的账号访问服务器的时间分布是随机的，并且平均频率低于1次/秒，但是异常账号会在一秒内发出多次请求，对于某些特定的应用接口，访问的时间间隔高度接近。通过对这些规律的总结和归纳，我们可以开发出一些方法对攻击者进行防御，但是越是明显的特征往往也越容易被绕过——也就是说，这样的方法的鲁棒性较弱。</p>

<p>今年来，不少学术界和工业界的科学家和工程师运用数据科学的知识探索出一些新的方法，这些方法利用数据挖掘算法将数据中一些隐蔽的规律特征——甚至是无法用语言描述的特征——发现出来。在这个方向上，对于异常账号检测的方法论正在逐渐形成。</p>

<p>其实，账号异常检测会运用到许多领域的研究成果，例如异常检测、基于图的异常检测、垃圾信息检测等。一些文章将检测方案归纳为为基于行为特征、基于内容、基于图以及无监督学习。由于涉及的技术多样切复杂，我们这里不对所有的方案进行讨论。</p>

<h2 id="0x02-异常账号的分类">0x02 异常账号的分类</h2>

<p>异常账号是描述一类行为异常的账号的统称。实际上，异常账号这个概念在不同的角度会有不同的表述。按照异常账号表现形式的不同，我们可以将其划分为以下几个类别：</p>

<p>(1） 僵尸帐号(Social Bot），即由攻击者通过自动化工具创建的虚假帐号，能够模拟正常用户的操作如发布消息、添加好友等。</p>

<p>(2） Sybil/Spam 帐号，指攻击者创建的用于隐蔽攻击的虚假身份账号。帐号主要用来发布广告、钓鱼、色情等信息，或用来恶意改变社交网络中的信誉，如恶意互粉、添加好友、点赞等行为。Spam账号是Sybil账号在应用阶段的统称。</p>

<p>(3） Compromised帐号，即被劫持帐号。这些帐号原本是正常帐号，但被攻击者劫持来执行恶意行为。</p>

<p>不同类别的账号所应用的检测方法也有差别，例如针对Spam帐号的检测主要侧重于恶意行为和恶意内容的特征，而针对 Compromised 帐号的检测主要利用帐号行为的突变来进行。基于这个原因，我们必须提一下Spam Campaign这种类型，它操纵大量虚假帐号以及盗用的Compromised帐号在集中时间段来传播恶意信息或执行其他恶意行为，称其为 SpamCampaign，这种类型的账号 可能包含僵尸账号、spam账号以及被劫持的账号等。针对这一类账号的检测主要通过这些帐号在同一时间段内的群体行为，如同时发布相同消息或者同时点赞某个页面等。</p>

<p>这几类帐号的分类不是绝对的也不是互相排斥的，只是为了更好的标识异常帐号在不同阶段的不同表现。</p>

<h2 id="0x03-检测方法的分类">0x03 检测方法的分类</h2>

<p>这些年针对在线社交网络异常账号检测在学术界和工业界提出了大量的方案。根据国内研究者的总结，这些方法大概可以被归纳为4个类型：</p>

<ul>
  <li>基于行为特征</li>
  <li>基于内容</li>
  <li>基于图</li>
  <li>无监督学习</li>
</ul>

<table>
  <thead>
    <tr>
      <th style="text-align: center">分类</th>
      <th style="text-align: center">思想</th>
      <th style="text-align: left">特征</th>
      <th style="text-align: left">方法</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">基于行为特征</td>
      <td style="text-align: center">分类</td>
      <td style="text-align: left">用户行为特征</td>
      <td style="text-align: left">有监督</td>
    </tr>
    <tr>
      <td style="text-align: center">基于内容</td>
      <td style="text-align: center">分类</td>
      <td style="text-align: left">消息内容</td>
      <td style="text-align: left">有监督</td>
    </tr>
    <tr>
      <td style="text-align: center">基于图</td>
      <td style="text-align: center">图中的异常检测</td>
      <td style="text-align: left">图结构</td>
      <td style="text-align: left">无监督</td>
    </tr>
    <tr>
      <td style="text-align: center">无监督学习</td>
      <td style="text-align: center">聚类/模型</td>
      <td style="text-align: left">multi</td>
      <td style="text-align: left">无监督</td>
    </tr>
  </tbody>
</table>

<h5 id="1基于行为特征">1.基于行为特征</h5>

<p>异常账号的目的是通过恶意行为获得经济利益，为了追求更高的回报，总会设法提高各类恶意操作的频率。异常账号的某些行为特征与正常的账号之间必然会有分别。基于行为特征的检测方案，可以看做数据挖掘中的分类问题——也就是说，检测者需要收集各种各样的行为特征，这些特征具备区分正常用户和异常用户的属性，通过选择某一特定的特征，将这个特征下采集到的数据样本分类，从而筛选出异常的账号。有时候一个特征就可以满足这个需求，而有时候需要多个特征结合起来才能形成区分度。</p>

<p>前面提到过，选取不同的特征可以检测不同类型的异常账号。比如提提取账号注册的时间、ip分布、注册时的手机号可以检测僵尸账号，利用消息发布的频率、评论数、相似度等可以用来检测spam账号。下表引用了张玉清教授等人总结的特征的类型。</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">类别</th>
      <th style="text-align: left">特征</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">用户个人信息</td>
      <td style="text-align: left">用户名长度、用户简介长度、帐号注册时间、用户名命名规则、被访问次数</td>
    </tr>
    <tr>
      <td style="text-align: center">用户行为</td>
      <td style="text-align: left">消息发布时间间隔、评论回复时间、帐号注册流程、帐号点击顺序、点赞数</td>
    </tr>
    <tr>
      <td style="text-align: center">好友关系</td>
      <td style="text-align: left">好友数、粉丝数、关注数、好友请求/好友数、关注数/粉丝数、好友网络聚类系数、二阶好友数、二阶好友消息数</td>
    </tr>
    <tr>
      <td style="text-align: center">消息内容</td>
      <td style="text-align: left">消息中 URL 比率、#比率、@比率、消息相似度、消息单词数、消息字符数、评论数、Spam 关键词数、消息来源、消息数量、消息转发次数</td>
    </tr>
  </tbody>
</table>

<p>根据相关研究的统计结论，基于行为特征的检测方法，选取特征的重要性比选择算法更重要。不同的特征对检测结果的贡献度有所不同。另外，行为特征的选取，除特征的有效性（贡献度）要高以外，鲁棒性也应当尽可能强。攻击者通过辨别防御者的策略会及时更改绕过策略，而鲁棒性强特征使攻击者不易发现。另外，通过采用在线学习的办法可以及时更新模型，即使攻击者改变行为方式也能实时自动化训练模型。</p>

<h5 id="2基于内容的检测">2.基于内容的检测</h5>

<p>异常账号发布的消息异于常人，否则与正常账号没有分别。根据工作实践的观察，我们遇到的最常见的是通过招呼、留言等方式发送招嫖信息给男性用户。那么检测消息中是否含有恶意内容，就可以发现这部分异常账号。</p>

<p>通过检测消息内容中被标记为恶意URL来识别实施钓鱼攻击的恶意账户，通过消息特征的突变来检测通过撞库等手段劫持的账号：通过时间、消息来源、消息语言、消息主题、消息中的链接、直接用户交互、邻近行等7个维度来建模，然后判断某一时间点之后的的消息是否与这个模型有所偏离来判定被盗的概率。</p>

<p>此外，攻击者会扩大消息的传播范围以扩大收益，而这些消息往往具有极高的相似性。一项针对Twitter的统计表明，约63%的消息是基于模板产生。他们根据这一特性设计了Tangram，将已知的恶意消息分割来生成匹配模板，然后用模板去检测更多的恶意消息。另一条可行的思路是将用户发送的消息进行聚类，找到发布大量相似消息的群组，如果这些消息被判定为恶意消息，则认为发布消息的账号属于恶意账户。这种方法已经在Facebook和Twitter得到运用。</p>

<p>然而，基于内容的检测与基于行为特征的检测一样，是有监督学习的方法。攻击者可以通过反复变化消息内容以达到绕过检测框架的目的。</p>

<h5 id="3基于图的检测">3.基于图的检测</h5>

<p>在一个社交网络中，异常账号的社交关系——即它与其他账号的连接形态和结构——会与正常账号有所不同，这是因为异常账号的关系网络往往服务于牟利的目的，它的分布有异于正常用户关系网随机分散的特点。如果想模仿正常用户构建异常用户的关系网络，那么攻击者就必须花费大量成本。基于图的检测方案的本质是异常帐号与正常帐号在组成的图中具有不同的结构或者连接方式，因此基于图的检测方案关键是构造一个图，在图中异常帐号与正常帐号具有不同的结构或者连接方式，然后利用图挖掘的相关算法找到图中具体的异常结构或者异常节点。</p>

<p>在社交网络图中，正常账号和异常账号分别形成较密集的结构，而正常账号和异常账号之间存在稀疏的连接。目前利用图计算的异常挖掘检测方案主要有随机游走、社区发现以及其他特定业务场景下设计的方案。利用随机游走算法，通过计算节点与已知的正常节点之间的关系来判断帐号是否为异常，例如，通过随机游走算法选取一部分节点作为根节点，然后进行广度优先搜索，如果一个节点被搜索到的次数大于一个阈值，那么就判定为正常节点，否则为Sybil/Spam 节点。一些研究者认为基于随机游走算法的Sybil/Spam检测方案对于网络结构和攻击模型的假设在现实网络中并不成立。现实网络结构中正常节点并不是快速融合的而是形成多个社区结构，社区内是紧密联系而社区间存在稀疏的割边，而且攻击者创建的Sybil/Spam节点能够与其他正常节点建立大量的连接，因此利用随机游走算法的方案存在较大的误检率。因此将随机游走检测方案改进，由区分正常节点与 Sybil节点转变为判断正常节点所在社区内其他节点的正常概率，实验表明这种方案更有优势。</p>

<p>此外，社交网络中除了显性的好友关系图，还存在大量利用其他关系（如好友请求、点赞、分享和转发等关系）组成的隐性关系图。一些工作利用隐性关系组成的图来检测异常帐号。</p>

<h5 id="4无监督学习的检测">4.无监督学习的检测</h5>

<p>基于行为特征和基于内容的检测方案都是有监督学习的方案，对分类器的训练需要提前对帐号状态进行标记，样本的数量与质量对于检测结果有较大的影响；基于图的检测方案尽管是无监督学习的，但是需要构建图结构。无监督学习的检测方案不需要提前对数据进行标记，因此能够更快的形成检测系统。根据具体的算法我们将方案分为两类：基于聚类和基于模型。</p>

<p>基于聚类的方案本质上也是一个数据挖掘的聚类问题。通过对帐号的某些特征进行聚类，将正常或者异常的账号聚位一类或几类，然后抽样检验，如果发现一类中正常或异常的比例超过某一阈值，就判定该类为非一个正常或者异常集。基于聚类的检测方案的关键是选择合适的特征对帐号进行聚类。一项针对twitter的研究使用了用户个人信息和消息内容进行聚类，而另一项试验使用了http请求的时间序列特征进行了聚类。这里需要提到一点，基于聚类的方法和前文所述的基于特征的检测方法是有差别的，因为基于特征的方法是一个分类问题，而分类问题需要事先对数据进行标记，然后选择不同的分类算法对数据进行分类。而聚类方法，只选择一些特征（维度），从中挖掘数据之间的共性和差异，以此将数据划分为若干个集合。</p>

<p>基于模型的方案的前提条件是认为正常用户的行为符合某种模型。因此，基于模型的特征要求使用大量正常账号进行训练形成模型，然后使用模型去识别异常的账号。腾讯的工程师在这个方向上的研究工作归纳出定义异常行为的两个指标：（1）同步值，即社交网络中异常帐号经常具有相同的行为；（2）异常值，即这些帐号的行为与大部分其他帐号的行为不同。通过计算这两个值，对于低于阈值的帐号判断为异常帐号。无监督学习的检测方案是目前异常帐号检测的新方向。无监督学习方案不需要提前对样本进行标识，因此能够检测到未知的恶意行为。</p>

<p>分类，是按照一些标准和规则，将样本打对应的标签，根据标签分类。聚类，是开始时没有标签，只能通过某种共性，找出对象之间存在的共性。聚类前不知道要划分成几个组，什么组，也不知道根据哪些规则来定义组。</p>

<h2 id="0x04-小结">0x04 小结</h2>

<p>基于行为特征和基于内容的检测方案是有监督学习方案，优点是只要训练形成了分类器，就能够对异常帐号进行检测而且能够区分不同类别的异常帐号，检测准确率较高，但需要提前对样本数据进行标记，只能够检测已知的攻击类型，容易被攻击者绕过。基于内容的检测方案能够做到对异常帐号实时检测，但是只能够检测发布恶意消息的异常帐号。基于行为特征和基于内容的检测方案目前比较成熟，不单有理论的研究还有现实中大规模的部署。基于图的检测方案利用了图结构特征，抗扰动能力强，但是需要建立相应的图结构，检测的精度也较低，目前处于理论研究阶段，还没有形成大规模部署的经验。无监督学习方案不需要提前对样本数据进行标记，能够较快形成检测系统，同时能够检测未知的攻击行为，且不易被攻击者绕过，但是这种检测方案不容易区分不同类型的异常帐号，而且需要对大量数据进行学习。因此可以结合多种不同的检测方案，从不同的层次对异常帐号进行检测，如可以先采用无监督学习的方案检测未知的攻击行为，然后对攻击行为抽取特征，再利用有监督学习的方案进行检测。</p>


  </div>

  <footer class="article-footer">

  <section class="share">
  <a class="share-link" href="" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
    Twitter
  </a>
  <a class="share-link" href="" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
    Facebook
  </a>
  <a class="share-link" href="" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530'); return false;">
    Google+
  </a> 
</section>


  <hr/>

  <section class="author">
  <div class="authorimage box" style="background: url(/assets/img/avatar.jpg)"></div>
  <div class="authorinfo box">
    <p>Author | Invoker</p>
    <p class="bio">
	安全工程师，目前就职于国内某首屈一指的基于地理位置的陌生人社交应用。
    </p>
  </div>
</section>


  </footer>

  


</article>

          </div>
        </div>
      </div>
      <footer class="site-footer">
  <div class="container">
    <div class="footer left column one-half">
      <section class="small-font">
        Theme <a href="https://github.com/wild-flame/jekyll-simple"> Simple </a> by <a href="http://wildflame.me">wildflame</a>
        © 2016 
        Powered by <a href="https://github.com/jekyll/jekyll">jekyll</a>
      </section>
    </div>

    <div class="footer right column one-half">
      <section class="small-font">
        
        <a href="https://github.com/wangzf0225"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span></a>

        
        
        <a href="https://twitter.com/Mega991"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span></a>

        
      </section>
    </div>
  </div>
</footer>
 
    </div>
  </body>
</html>
