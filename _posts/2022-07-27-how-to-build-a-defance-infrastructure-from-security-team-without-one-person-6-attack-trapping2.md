---
layout: post
title:  "在“没有人的安全部”构筑护网防御工事（6）——攻击诱捕"
date: 2022-07-26 02:06:26 +0800
author : Invo
categories: original
---

# 第六部分 攻击诱捕

# 1 概述（what）

## 1.1 含义

写在前面:按照最开始的想法，这一章会写关于特权访问的问题。直到写到这里，发现特权管理的主要内容其实已经在账号扫雷这一章节中包含，只不过账号扫雷针对所有的账号对象，特权访问只是其中的操作系统、数据库、管控系统等这些特权系统的用户管理。特权访问是近年来新兴的一个概念，从信息安全体系上讲概念的内涵是很丰富的，只不过在这里我们只关心其中的一小部分，如果读者感兴趣可以搜索privileged access关键字了解其内容。

## 1.2 原理

攻击诱捕即以蜜罐为基础的诱骗和溯源技术，近年来商业化产品开始使用“攻击诱捕”这一词汇作为商业包装，而这个提法也比较贴切，因此我们在这里沿用。攻击诱捕通过制造伪装的应用系统迷惑和诱骗攻击者，并通过伪造的业务流程引导攻击者留下与个人身份直接或间接相关的信息，从而达到识别攻击意图、检测攻击行为以及反制攻击者的目的。


## 1.3 原则

最小可用，非必要不开放是网络隔离的核心原则。当然，理想的做到最小可用是非常难的，要么网络结构极其简单，要么就是大型网络有非常良好的架构设计，能够以简单清晰的网络结构支持复杂的业务类型需要的网络形态（例如业务网除了常规的http以外，还可能有RPC、RDMA或者一些私有协议等等，在业务网以外还有管控网，在业务和管控网外还有带外管理网等）。合理的网络安全域划分能够优化网络架构，合理的网络架构容易设计访问控制策略，因此网络的设计是需要架构师做好的工作。

当然，当我们只讨论护网的场景，问题就简单多了，如果尽可能的缩小我们在网络大边界上暴露的范围，我们的目的就达到了。

# 2 目的（why）

网络隔离的核心作用是缩小攻击面，道理很简单，但没有丰富攻防对抗经验的朋友也行难以理解网络隔离的价值。良好的边界网络隔离可以大幅降低攻击的风险，如果要做且只能做一样安全措施来应对网络攻击的风险，那笔者一定选择网络隔离，这也是这篇文章被放在第一篇的原因。毫不夸张的说，良好的网络边界管理可以使风险水平降低70%甚至更多。

# 3 方案（how）

那么如何做好网络边界隔离，笔者总结了一般步骤。

1. 定义功能域

首先根据网络架构的设计，按照功能属性将网络划分成一些不同的集合。划分的层次不同，粒度也随之不同。通常我们最关注顶层的划分，即包含：互联网、生产网、测试网、办公网，一些地方还会设计开发网、OA网等等。

2. 划分安全性等级

不同安全性的网络域之间一定要做网络隔离，除非你能将所有的网络域都按最高安全等级来防护。但是即便如此，也没有人会把不同安全性的网络放在同一个网络域当中，因为当你低安全等级网络域达到A级，你会希望高安全等级网络域达到A++级，而且如果网络访问的顺序是从低到高的安全性，那么网络隔离本身也会从概率上降低攻击者侵入的可能性。

3. 访问控制矩阵

访问控制矩阵具有相同的行和列表头，列表头代表源端，行表头代表目的端，任意两个行列元素对应的表格值就是对应该方向的访问控制策略。例如，列表头是网络A，行标头是网络B，那么表格中对应的单元格的值就是从A网络到B网络的访问控制策略的具体内容，例如允许A网络全部地址访问B网络全部443端口 ，A网络全部地址禁止访问B网络全部22端口，默认Deny。访问控制矩阵可以写在Excel中，格式如下表，读者可以根据自己的需要调整。

有了这样一张表格，就可以清晰的梳理整个网络系统的所有边界访问控制策略。当然在护网的大背景下，重点是互利网边界和办公网边界，通常访问控制策略会将限制在80和443这类web端口，并且禁止其他一切端口。


4. 逃生策略

在网络边界的隔离方案的设计过程中，有一类需求应当谨慎地被考虑，这就是逃生策略。护网背景下的网络访问控制措施是比较严格的，因此当配置出现一些失误，或者设备出现故障时，很可能导致正常的业务无法运转，而由于问题发生在网络上，所以用来排除故障的应急恢复手段可能也无法执行。因此，在访问控制策略的设计中需要考虑保留个别网络通道，能够访问网络中最重要的设备，通过这条通道可以执行网络运维操作并恢复网络通信能力。这样的通道应该是个别的、保密的、功能有限的但具备特权的。逃生通道的使用源端最好也通过网络设备绑定IP、MAC地址或其他唯一性标识。

5. 网络变更

网络安全域隔离最终一步是落地执行。从安全角度考虑，网络的限制越严格越好，但对业务有时候会带来负面的影响。因此，在确保网络访问控制策略合理的同事，也应该确保策略最终正确的被执行，而不是出现计划外的结果。网络变更最主要考虑稳定性风险，因此需要注意灰度发布、尽可能通知到相关的业务方等等。

# 4 需要注意的一些问题




# 5 展望？