---
layout: post
title:  "一种归一化的信息系统安全度量方法"
date: 2022-05-09 03:06:26 +0800
author : Invo
categories: original
---
# 摘要
本文设计了一种以百分制方式定量评估系统安全性的方法，通过风险赋值和此基础之上的计算，得到一个符合系统整体安全水平的分数。该方法应满足适用于不同资产规模的系统，通过调节系统参数，可以对不同系统的安全水平进行横向对比。该方法对低危风险不敏感，更关注高危风险，也就是说脆弱性的利用的难易程度和实际危害最终将在整体分数上体现。同时，当一个系统被多个高危漏洞影响的时候，系统的安全水位不会因高危漏洞的数量变多而线性降低，它只会无限趋近于某一个极限值。

# 引言
对于一个存在风险的信息系统，通常通过量化指标的方式对其进行安全性评估。这里的安全性评估代表被攻击后能被成功入侵的可能性数字表示（这个数字的数值代表被成功入侵的难以程度，但不直接表示概率）。在很多SIEM或SOC系统中，可以看到的一种做法是给每一个风险点进行分数赋值，找出所有的风险并累加分数就可以得到一个风险分数。有些系统会根据风险点的某些属性设置权重，最后通过加权计算得到风险分数，这些方法本质上都是把分数进行累加。这种方法很简单，但是存在一个明显的缺陷就是当一个信息系统规模特别庞大时，如果出现的低风险漏洞很多，也容易累加出一个很高的分数。但熟悉渗透测试的人都知道，许多低风险漏洞在实际对抗中没有任何价值。因此这样计算出的分数对于描述系统的实际风险具有较大的误差。从经验上讲，我们希望对信息系统安全状态的描述更倾向于给出一个符合直觉的判断，举例来说，如果以百分制作为标准，当一个系统的安全分是90分的时候，我们感觉这个系统总体上是安全的，但是当它的安全分是10分的时候，我们认为它可能存在比较大的安全隐患。（当然我们也可以对调安全性和风险性的坐标，用“风险分”代替“安全分”，相应的描述也应该是相反的。）

基于这样的背景，就需要一个客观的算法对系统的安全水平进行评估。它需要对风险因素的数量规模不能那么敏感，同时又要反应系统被攻击后失陷的难易水平。对于具体的设计原则，后文中有更详细的介绍。

需要指出的是，这种方法不同于标准的风险评估中通过“资产”“威胁”“脆弱性”三要素进行的风险评估方法，仅仅作为一种符合日常需求的“最佳实践”方案。

# 方案设计

## 需求

如在引言中提到的，系统安全性的评估有时候需要一个符合直觉感受的定量测算的方法。这种方法可以在不同的系统上测算，得到的分数可以用于不同系统间横向比较，而分数的高低可以反应系统安全水平的差异，而这种差异也是可以被验证的。也就是说，当A系统的风险分高于B系统时，就可以通过渗透测试验证A系统比B系统更容易被攻陷。而对于资产和漏洞差别较大的系统，需要有一个统一的参考系才能建立这把统一的标尺。通常习惯于使用百分制作为这个参考系，0和100是这个参考系的两极。

在明确了度量方法的形式以后，它的第二个重要领域则是如何将系统本身的风险因素反应在分数上。一个系统内部和外部通常具有不止一个风险因素，不同的风险因素带来的影响和危害程度不尽相同。在信息安全领域，最严重的风险通常包括系统权限被完全控制、系统宕机拒绝服务、敏感数据泄露等等，如果某个系统具有一个这样严重的风险因素，那么他的安全分就应该大打折扣，而具备多个风险点的时候，累加扣除的风险分值反而是趋于收敛的。因为系统安全分的下限不会变成负数，而从经验上看，一个系统被击穿一次和击穿数次，都证明它的安全性很差，对于一个在要害部位被捅了刀子的人而言，一刀和几刀没有太大差别，最终结果是一样的。

基于以上考虑，我们把度量方法的需求提炼归纳为以下几条：
+ 满分为100分，取安全性作为分数的正方向，及风险水平与安全评分负相关，评分越高，安全水位越高。
+ 系统对不同严重程度的风险因素敏感程度不同，越严重的风险影响越大，越轻微的风险影响越小。
+ 在不同的评分区间对漏洞的严重等级敏感程度不同，当漏洞较少时，单个漏洞造成的扣分较多，漏洞较多时单个漏洞扣分较少。
+ 越严重的风险对分值的影响越大，而且严重程度的影响会随着风险赋值几何增加，而不是线性增加。例如风险因素分为1、2、3、4四个档位，它们最终造成的扣分可能是1、5、20、50。
+ 评分的下限是0分，不会出现负分的情况。
    
   

## 分析

有了整体的方向，就开始构思如何去实现。

首先困扰我的，是如何把风险累加的结果设计成有限的，这个过程不应该人为的控制，而是由于算法的数学特性自动反应在结果上的。于是我想到了有限函数，函数在无穷远处逼近一个极限，这样才能保证当风险因素不断叠加后，分数不会低于0。而风险因素的变化对分数的影响是一致的，于是我想到函数的单调性，于是这个函数应该是一个单调有限函数。回忆学过函数类型，一元一次函数、一元n次函数都没有极限，三角函数不单调，剩下的就是指数函数、幂函数和双曲线函数。

其次，当风险因素的赋值是线性的，而不同的赋值对分数的影响是非线性的。我想到给输入的风险因素赋值加一个权重系数，用于放大不同等级的风险对分数的影响。改变权重系数，可以调节对不同等级风险的差异放大的效果。

第三，函数应该是单调递减的，没有风险的时候分数是100，随着风险的增加，安全分不断降低（安全分=100-风险分），直至趋近于0。因此在定义域是0到正无穷的范围内，计算风险分的函数的变化区间是0到某个数值，最终通过乘一个系数调整成0到100。

综合以上要求，我们发现幂函数可以通过一些变换来达到想要的效果，因此我们把目光锁定在e的x次方这个表达式上。

## 设计

## 使用

脆弱性赋值
不同级别的漏洞代表不同的脆弱性，那么如何界定脆弱性的严重程度，需要一套可以量化的方法。这里从紧急-重要两个维度区分脆弱性的严重程度，其中紧急优先于重要。
表 3 9 脆弱性分级
    紧急  不紧急
重要  严重  中
不重要 高   低

依照上表所示，根据紧急和重要程度的不同，脆弱性被分为严重、高、中、低四级，在本方案中，这四种等级的脆弱性赋值依次为4、3、2、1。
表达式
我们设计的表达式如下
RISK SCORE=100- 100EXP[-∑_(i=1)^4▒x_i/p_i ]=100-100∏_(i=1)^4▒e^(-x_i/p_i ) 
x_i是某个级别的脆弱性赋值的总和，其中，x_1，x_2 〖，x〗_3，x_4分别代表低危、中危、高危、严重四个等级的告警单项风险分值求和后的总分。同级别所有脆弱性的得分累加到一起就是这个x_i的值，例如3个低危漏洞的脆弱性赋值总和是1*3=3，5个严重漏洞的脆弱性赋值总和是4*5=20。需要注意的是同一种漏洞的脆弱性赋值需要分别计分，不可以合并成一项脆弱性。
p_i是一个用来修正风险权重的系数，我们约定p_1=50，p_2=18〖，p〗_3=12，p_4=5。
按照上式计算出的最终得分，就是冬奥云上应用系统的最终安全态势评分。


# 总结